# Исправление проблемы с удалением мест

## Проблема
Места не удаляются из-за RLS (Row Level Security) политики в Supabase, которая блокирует операцию DELETE.

## Решение

### Вариант 1: Исправить RLS политики (Рекомендуется)

1. Откройте [Supabase Dashboard](https://app.supabase.com)
2. Выберите ваш проект
3. Перейдите в **SQL Editor** (в левом меню)
4. Откройте файл `fix-rls-policies.sql` из корня проекта
5. Скопируйте весь SQL код
6. Вставьте в SQL Editor
7. Нажмите **Run** (или F5)

Скрипт:
- Проверит текущие RLS политики
- Создаст политику для удаления мест создателем
- Включит RLS для таблицы places

### Вариант 2: Проверить существующие политики

Если политика уже существует, но не работает:

1. В Supabase Dashboard перейдите в **Authentication** > **Policies**
2. Найдите таблицу `places`
3. Проверьте политики для операции **DELETE**
4. Убедитесь, что есть политика вида:
   ```sql
   CREATE POLICY "Users can delete their own places"
   ON places
   FOR DELETE
   USING (auth.uid() = created_by);
   ```

### Вариант 3: Временное отключение RLS (НЕ рекомендуется для продакшена)

⚠️ **ВНИМАНИЕ**: Это отключает безопасность. Используйте только для тестирования!

```sql
ALTER TABLE places DISABLE ROW LEVEL SECURITY;
```

После тестирования обязательно включите обратно:
```sql
ALTER TABLE places ENABLE ROW LEVEL SECURITY;
```

## Проверка после исправления

1. Обновите страницу приложения
2. Попробуйте удалить место
3. Проверьте консоль браузера - должно появиться "Place deleted successfully and verified"
4. Место должно исчезнуть из списка

## Если проблема сохраняется

1. Проверьте в Supabase Dashboard:
   - Включен ли RLS для таблицы `places` (должно быть `ENABLED`)
   - Есть ли конфликтующие политики DELETE
   - Правильно ли настроена аутентификация

2. Проверьте логи в консоли браузера для деталей ошибки

3. Убедитесь, что `userId` совпадает с `created_by` места (проверьте в логах)
